<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/simple.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/agate.css">
</head>
<body>
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-109711864-1', 'pivovarit.github.io');
    ga('send', 'pageview');

</script>
<div class="reveal">

    <div class="slides">
        <section>
            <h2>Embracing Microservices</h2>
            <h4><a href="http://pivovarit.github.io"> Grzegorz Piwowarek</a></h4>
            <h5><a href="http://twitter.com/pivovarit">@pivovarit</a></h5>
        </section>

        <section>
            <h3>{ <a href="http://4comprehension.com/">4comprehension.com</a> }</h3>
            <h4>Owner/Independent Consultant @ 4Comprehension</h4>
            <h4>WarsawJUG Leader</h4>
            <h5><a href="http://twitter.com/pivovarit">@pivovarit</a></h5>
            <br>
        </section>

        <section>
            <h2>Questions: http://sli.do</h2>
        </section>

        <section>
            <img src="img/snake.jpg" width="60%"/>
        </section>

        <section data-transition="fade">
            <img src="img/microservices.jpeg" width="80%"/>
            <small><a href="https://twitter.com/ddprrt/status/1425418538257428488">https://twitter.com/ddprrt/status/1425418538257428488</a></small>
        </section>

        <section data-transition="fade">
            <img src="img/microservices-2.jpeg" width="80%"/>
            <small><a href="https://twitter.com/ddprrt/status/1425418538257428488">https://twitter.com/ddprrt/status/1425418538257428488</a></small>
        </section>

        <section>
            <img src="img/hoare.jpg" width="30%"/>
            <blockquote
                    cite="https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare/">
                "It was the invention of the null reference in 1965...I call it my billion-dollar mistake."
            </blockquote>
            <small>Tony Hoare</small>
        </section>

        <section>
            <img src="img/future-null.jpg" width="60%"/>
        </section>



        <section data-transition="fade">
            <h4>Another <em>"billion-dollar mistake":</em></h4>
            <h3 class="fragment">Microservices</h3>
        </section>

        <section data-transition="fade">
            <h4>Another <em>"billion-dollar mistake":</em></h4>
            <h3>"Micro"</h3>
        </section>

        <section data-transition="fade">
            <h3>Antipattern #1: Size Obsession</h3>
            <h4 class="fragment">Microservice vs service?</h4>
            <h4 class="fragment">How small is "micro"?</h4>
            <h5 class="fragment">N lines of code?</h5>
            <h5 class="fragment">N classes?</h5>
            <h5 class="fragment">N MBs?</h5>
            <h5 class="fragment">Rewritable in X time?</h5>
        </section>

        <section>
            <h4>Microservices: the Main Idea</h4>
            <h3 class="fragment">Independence through Modularity</h3>
        </section>

        <section data-transition="fade">
            <img src="img/tight-coupling.png" width="50%"/>
            <br>
            <small>source: <a href="https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/">https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/</a></small>
        </section>
        <section data-transition="fade">
            <img src="img/loose-coupling.png" width="50%"/>
            <br>
            <small>source: <a href="https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/">https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/</a></small>
        </section>

        <section>
            <blockquote cite="Building Microservices by Sam Newman">
                "The smaller the service, the more you maximize the benefits and downsides of microservice architecture."
            </blockquote>
            <small>Sam Newman</small>
        </section>

        <section>
            <img src="img/netflix.png" width="70%"/>
            <br>
            <small>author: Bruce Wong</small>
            <h3 class="fragment">Netflix: 2000 engineers</h3>
        </section>

        <section>
            <h5>Do not ask about the max size, but when to split</h5>
            <br>
            <h5 class="fragment">The #1 rule of distributed systems: don't do it until you have to</h5>
        </section>

        <section>
            <h3>The Pragmatic Default</h3>
            <img src="img/citadel.png" width="50%"/>
            <small><a href="https://twitter.com/dhh/status/1247522358908215296</small">https://twitter.com/dhh/status/1247522358908215296</a></small>
        </section>

        <section>
            <h3>Antipattern #2: Old Habits Die Hard</h3>
            <h5 class="fragment">Single version for all services</h5>
            <h5 class="fragment">All-or-nothing deployments</h5>
            <h5 class="fragment">Dedicated "DevOps" bottleneck teams</h5>
            <h5 class="fragment">End-to-end Acceptance tests</h5>
        </section>

        <section>
            <blockquote cite="Building Microservices by Sam Newman">
                "Can you make a change to a service and deploy it by itself without changing anything else?
                If the answer is no, then many of the advantages we discuss throughout this book will be hard for you to
                achieve."
            </blockquote>
            <small>Sam Newman</small>
        </section>

        <section>
            <h3>Monorepos</h3>
            <h5 class="fragment">make it easy to stick to old habits</h5>
            <h5 class="fragment">- require extra discipline</h5>
            <h5 class="fragment">- require extra tooling</h5>
        </section>

        <section>
            <h4>Antipattern #3</h4>
            <h3>Not Embracing Eventual Consistency</h3>

            <h6>So you have 150 services and they all need to be up and responsive at the same time for the whole system to work?</h6>
        </section>

        <section>
            <h3>Sync vs Async</h3>
            <h4 class="fragment">Both are good choice if you understand trade-offs</h4>
            <h5 class="fragment">Consistency vs Availability</h5>
            <br>
            <h4 class="fragment">Want to be fully independent? Forget about Strict Consistency</h4>
        </section>

        <section data-transition="fade">
            <img src="img/sync1.png" width="80%"/>
        </section>

        <section data-transition="fade">
            <img src="img/sync2.png" width="80%"/>
        </section>

        <section>
            <h4>Antipattern #4:</h4>
            <h3>Accidental Consistency</h3>
            <h5>Eventual Consistency != Accidental Consistency</h5>
        </section>

        <section data-transition="fade">
            <img src="img/dual-write.png" width="60%"/>
        </section>

        <section data-transition="fade">
            <img src="img/dual-write-2.png" width="60%"/>
        </section>

        <section>

            <pre><code class="hljs language-java" data-trim data-noescape>
                @Transactional
                public void createUser(CreateUserCommand command) {
                    var user = from(command);

                    persist(user);                     // 1
                    send(UserCreatedEvent.from(user)); // 2
                }
            </code></pre>
            <h4><code>@Transactional</code> won't save you in the distributed world</h4>
        </section>

        <section>
            <h3>Change Data Capture</h3>
        </section>

        <section data-transition="fade">
            <h4>Dual-Write (distributed transaction)</h4>
            <img src="img/cdc3.png" width="50%"/>
        </section>

        <section data-transition="fade">
            <h4>Change Data Capture</h4>
            <img src="img/cdc4.png" width="50%"/>
        </section>

        <section>
            <h4>Transactional Outbox Pattern</h4>
            <h4>Debezium</h4>
        </section>

        <section>
            <h4>Antipattern #5:</h4>
            <h3>Technology Heterogeneity</h3>
            <img src="img/goldblum.jpeg" width="70%"/>
        </section>

        <section>
            <h4>Sounds great on paper</h4>
            <h5 class="fragment">Most companies will benefit more from standardized tech stacks with occasional experiments</h5>
            <h5 class="fragment">Don't throw in new tech unless there's a good reason for it</h5>
        </section>

        <section>
            <h5>Antipattern #5:</h5>
            <h3>Shared Libraries</h3>
        </section>

        <section>
            <h4>Thank You!</h4>
            <h4><a href="http://twitter.com/pivovarit">@pivovarit</a></h4>
            <small><a href="https://4comprehension.com">4comprehension.com</a></small>
            <br>
            <img src="img/qrcode.png" width="30%"/>
            <br>
            <small><a href="https://pivovarit.github.io/talks/embracing-microservices">https://pivovarit.github.io/talks/embracing-microservices</a></small>
        </section>
    </div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });
</script>
</body>

</html>
