<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/simple.css">

    <link rel="stylesheet" href="plugin/highlight/zenburn.css">
</head>
<body>
<div class="reveal">
    <div class="footer"><a href="http://twitter.com/pivovarit">@pivovarit</a></div>

    <div class="slides">
        <section>
            <h3>Challenges of Distributed Systems</h3>
            <br><br>
            <h4><a href="https://pivovarit.github.io"> Grzegorz Piwowarek</a></h4>
            <h5><a href="https://twitter.com/pivovarit">@pivovarit</a></h5>
        </section>

        <section>
            <h2>{ <a href="https://4comprehension.com/">4comprehension.com</a> }</h2>
            <h4>WarsawJUG | Vavr | Oracle ACE</h4>
            <h4>Independent Consultant/Trainer</h4>
            <small>distributed systems | microservices | async | reactive | java</small>
            <h5><a href="https://twitter.com/pivovarit">@pivovarit</a></h5>
            <br>
        </section>

        <section>
            <h2>What makes systems...distributed?</h2>
        </section>

        <section>
            <h2>CAP Theorem</h2>
            <ul>
                <li><strong>C</strong>onsistency</li>
                <li><strong>A</strong>vailability</li>
                <li><strong>P</strong>artition tolerance</li>
            </ul>
        </section>

        <section>
            <h2>Consistency</h2>
            <h5>every read receives the most recent write</h5>
            <small>(a single-copy illusion)</small>
        </section>

        <section>
            <h2>Availability</h2>
            <h5>every request receives a non-error response</h5>
            <small>(even if some nodes are down)</small>
        </section>

        <section>
            <h2>Partition tolerance</h2>
            <h5>system continues to operate even if network links are lost</h5>
        </section>

        <section>
            <h4>distributed systems are systems that communicate over unreliable channels</h4>
        </section>

        <section>
            <p><strong>Rule:</strong> In the presence of a network partition, a distributed system must choose either
                <em>Consistency</em> or <em>Availability</em>.</p>
        </section>

        <section>
            <h3>...</h3>
        </section>

        <section>
            <img src="img/snake.jpg" width="70%"/>
        </section>

        <section data-transition="fade">
            <img src="img/microservices.jpeg" width="80%"/>
            <small><small><a href="https://twitter.com/ddprrt/status/1425418538257428488">https://twitter.com/ddprrt/status/1425418538257428488</a></small></small>
        </section>

        <section data-transition="fade">
            <img src="img/microservices-2.jpeg" width="80%"/>
            <small><small><a href="https://twitter.com/ddprrt/status/1425418538257428488">https://twitter.com/ddprrt/status/1425418538257428488</a></small></small>
        </section>

        <section>
            <img src="img/hoare.jpg" width="30%"/>
            <blockquote
                    cite="https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare/">
                "It was the invention of the null reference in 1965...I call it my billion-dollar mistake."
            </blockquote>
            <small><small>Tony Hoare</small></small>
        </section>

        <section>
            <img src="img/future-null.jpg" width="60%"/>
        </section>



        <section data-transition="fade">
            <h4>Another <em>"billion-dollar mistake":</em></h4>
            <h3 class="fragment">Microservices</h3>
        </section>

        <section data-transition="fade">
            <h4>Another <em>"billion-dollar mistake":</em></h4>
            <h3>"Micro"</h3>
        </section>

        <section data-transition="fade">
            <h4 class="fragment">Microservice vs service?</h4>
            <h4 class="fragment">How small is "micro"?</h4>
            <h5 class="fragment">N lines of code?</h5>
            <h5 class="fragment">N endpoints?</h5>
            <h5 class="fragment">N classes?</h5>
            <h5 class="fragment">N MBs?</h5>
            <h5 class="fragment">N responsibilities?</h5>
            <h5 class="fragment">Rewritable in X time?</h5>
        </section>

        <section>
            <h4>Microservices: the Main Idea</h4>
            <h3 class="fragment">Enable scalability through independence and modularity</h3>
        </section>

        <section data-transition="fade">
            <h4>Tight coupling - Low cohesion</h4>

            <img src="img/tight-coupling.png" width="50%"/>
            <br>
            <small><small>source: <a href="https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/">https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/</a></small></small>
        </section>
        <section data-transition="fade">
            <h4>Low coupling - High cohesion</h4>

            <img src="img/loose-coupling.png" width="50%"/>
            <br>
            <small><small>source: <a href="https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/">https://enterprisecraftsmanship.com/posts/cohesion-coupling-difference/</a></small></small>
        </section>

        <section>
            <h4>You can have modularity without microservices</h4>
            <img class="fragment" src="img/modular.png" width="50%"/>
            <small class="fragment">Naturally, you don't get all the benefits, but it's not a demanding investment</small>
        </section>

        <section>
            <img src="img/evolution.png" width="70%"/>
        </section>

        <section>
            <blockquote cite="Building Microservices by Sam Newman">
                "The smaller the service, the more you maximize the benefits and downsides of microservice architecture."
            </blockquote>
            <small>Sam Newman</small>
        </section>

        <section>
            <img src="img/netflix.png" width="70%"/>
            <br>
            <small>author: Bruce Wong</small>
            <h3 class="fragment">Netflix: 2000 engineers</h3>
        </section>

        <section>
            <img src="img/boat.png" width="50%"/>
        </section>

        <section>
            <blockquote cite="'How Netflix Really Uses Java' by Paul Bakker" width="100%">
                However, don't be fooled by the size of those microservices, because a lot of those so-called microservices at Netflix are a lot larger, just looking at the code base, than the big monoliths that I've worked at, at many other companies.
            </blockquote>
            <small>Paul Bakker</small>
            <br>
            <small><small>source: <a href="https://www.infoq.com/presentations/netflix-java/">https://www.infoq.com/presentations/netflix-java/</a></small></small>
        </section>

        <section>
            <h5>Do not ask about the max size, but when to split</h5>
        </section>

        <section>
            <h5>So... when do we split?</h5>
            <br>
            <h5 class="fragment">When it hurts too much</h5>
            <h5 class="fragment">The #1 rule of distributed systems: don't do it until you have to</h5>
        </section>

        <section>
            <img src="img/micro-monolith.jpg" width="70%"/>
        </section>


        <section>
            <h3>The Pragmatic Default</h3>
            <img src="img/citadel.png" width="60%"/>
            <br>
            <small> <small><a href="https://twitter.com/dhh/status/1247522358908215296</small">https://twitter.com/dhh/status/1247522358908215296</a></small></small>
        </section>

        <section>
            <blockquote cite="'Static Analysis at Scale: An Instagram Story' by Benjamin Woodruff" width="100%">
                Our server app is a monolith, one big codebase of several million lines and a few thousand Django endpoints [1], all loaded up and served together. A few services have been split out of the monolith, but we don’t have any plans to aggressively break it up.
            </blockquote>
            <small><small><a href="https://instagram-engineering.com/static-analysis-at-scale-an-instagram-story-8f498ab71a0c">https://instagram-engineering.com/static-analysis-at-scale-an-instagram-story-8f498ab71a0c</a></small></small>
        </section>

        <section>
            <h4>Reliability in an unreliable world</h4>
        </section>

        <section>
            <h4>When sending a message over unreliable channels, how to guarantee delivery?</h4>
        </section>

        <section>
            <h4>(...thought experiment...)</h4>
        </section>

        <section>
            <h3>Definition</h3>
            <p>An operation is <strong>idempotent</strong> if performing it multiple times produces the <em>same effect</em> as performing it once.</p>
            <br>
            <pre><code>f(f(x)) = f(x)</code></pre>
        </section>

        <section>
            <h3>Examples</h3>
            <ul>
                <li>Setting a user’s status to “active” → ✅</li>
                <li>Incrementing a counter → ❌</li>
            </ul>
        </section>

        <section>
            <h3>In a distributed system</h3>
            <p>Failures and retries are inevitable.</p>
        </section>

        <section>
            <ul>
                <li>Network retries may cause duplicate requests</li>
                <li>Clients or load balancers might resend operations</li>
                <li>Idempotency prevents unwanted side effects</li>
            </ul>
        </section>



        <section>
            <h3>Exactly-once delivery?</h3>
            <p><strong>A fairy tale.</strong> </p>
            <br><br>
            <div class="fragment">
                <p><strong>Reality:</strong> You only ever get:</p>
                <ul>
                    <li><strong>at-most-once</strong> → messages may be lost</li>
                    <li><strong>at-least-once</strong> → messages may be duplicated</li>
                </ul>
            </div>
        </section>

        <section>
            <h3>Exactly-once doesn’t exist</h3>
            <ul>
                <li>Networks can fail between <em>send</em> and <em>acknowledge</em></li>
                <li>Clients can retry</li>
                <li>Servers can crash mid-processing</li>
            </ul>
        </section>

        <section>
            <h3>Exactly-once <em>effect</em></h3>
            <p>We can’t guarantee <em>exactly-once delivery</em>,</p>
            <p>but we can design for <strong>exactly-once effect</strong> using idempotency.</p>
            <br>
            <pre><code>at-least-once delivery + idempotency = exactly-once</code></pre>
        </section>

        <section>
            <h2>PACELC Theorem</h2>
            <p>
                Daniel Abadi extended CAP to include trade-offs <em>when no partition occurs</em>:
            </p>
            <blockquote>
                <strong>If P</strong> (partition) → <em>A</em> or <em>C</em><br>
                <strong>Else</strong> (ok) → <em>Latency</em> or <em>Consistency</em>
            </blockquote>
        </section>


        <section>
            <blockquote>
                Using common sense is the ultimate Best Practice™.
            </blockquote>
        </section>
        <section>
            <h2>Thank You!</h2>
            <h5>Need help? Reach out! It's free.</h5>

            <br><br><br><br>
            <h4><a href="https://twitter.com/pivovarit">@pivovarit</a></h4>
            <small><a href="https://4comprehension.com">4comprehension.com</a></small>
            <br>
        </section>
    </div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });
</script>
</body>
<style>
    .footer {
        position: fixed;
        bottom: 0;
        width: 98%;
        color: black;
        text-align: right;
        padding: 10px 0px;
        font-size: 60%;
    }
</style>
</html>
